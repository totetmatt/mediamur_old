<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>Mediamur :: </title>
	<meta name="description" content="">

	<link href="minimal.css" rel="stylesheet">
	<script type="text/javascript">

		// Socket  
		var socket = null;

		// Image score to make it bigger, will be reseted at each page reload ;)
		var imageScore = {};

		//
		function changeStream() {
			// console.log(document.getElementById('streamId').value);
			document.getElementById("wrapper").innerHTML = '';
			socket.close();
			startWebsocket();
		}

		//
		function startWebsocket() {
			socket = new WebSocket(document.getElementById('streamId').value);
			socket.onopen = function() {
				console.log("Connected!");
			}
			socket.onmessage = function(e) {

				var data = JSON.parse(e.data);
				if(imageScore[data['hash']]  === undefined) {
					imageScore[data['hash']] = 0;
					document.getElementById("wrapper").insertAdjacentHTML('afterbegin', '<a target="_blank" href="'+data['url']+'"><img alt="'+data['hash']+' [=] '+data['id']+'" id="'+data['hash']+'" src="'+data['url']+'"/></a>')
				} else {
					document.getElementById(data['hash']).style.height = 100+(imageScore[data['hash']] *10)+"px"
					document.getElementById(data['hash']).style.width = 100+(imageScore[data['hash']] *10)+"px"
				 }
				imageScore[data['hash']] +=1;

			}
			socket.onclose = function(e) {
				console.log("Connection closed.");
			}
		};

		window.onload = startWebsocket
	</script>
</head>
<body>
	<div class="container">
		<header>
			
			<select onChange="changeStream();" id="streamId">
				<option value="ws://localhost:8080/media">Media Stream</option>
				<option value="ws://localhost:8080/user">User Stream</option>
			</select> 
				
		</header>
		<div class="row"><div class="col-12" id="wrapper"></div></div>
		<footer>
			Mediamur from <a href="">@totetmatt</a> |  <!-- Not required, but appreciated. -->Design <a href="http://minimalcss.com">Minimal</a>
		</footer>
	</div>
</body>
</html>